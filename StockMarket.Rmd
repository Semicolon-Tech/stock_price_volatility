---
title: "stock"
output: html_document
---
```{r}

```


```{r }
library(readr)
library(ggplot2)
library(forecast)
library(fpp2)
library(TTR)
library(dplyr)

```

Problem Statement
Just like every other market is to the sustaing of the economic so is the stock market.Because quiet a number of factors affect the stock market we  want to consider how volatile the nigerian stock market ia and we also forecast the stock market  for a twelve month period.The dat being used was gotten form Nigerian NSE all shares historical data
 The data contains 2150 rows and 6 variables, as described below:

date - represents the first date of every month starting from January 2012.

OPen - 
Close - 
High - 
Low - 
Vol. - 
change -


```{r}
shares<- read_csv(file.choose())
shares$Date <- as.Date(shares$Date, format = "%b %d, %Y", abbreviate = TRUE)
glimpse(shares)
View(shares)

```

```{r}
shares$Vol. <- as.numeric(shares$Vol.)
str(shares)
NROW(shares)
```

```{r}
shares$`Change %` <- as.numeric(shares$`Change %`)
str(shares)
```

#Now that the variables have been converted from character to factor, a summary statistiocs will be carried out to further confirm that





```{r}
glimpse (shares)

```

```{}


```

```{r}
cor(shares [,2:6])
```
The correlation between the open,high and low is same as the is same ie the variable have same impact on th analysis, so we are going to use on the price column

```{r}
# plot of  daily observation
shares1 <- ts(shares$Price, frequency = 365, start = 2012, end = )
plot.ts(shares1)
  NROW(shares1)
```

```{r}
# plot for monthly average
shares2 <- ts(shares$Price, frequency = 12, start = 2012, end = 2020)
NROW(shares2)
plot.ts(shares2)


```


```{r}
library(forecast)
library(MLmetrics)
```
```{r}
NROW(shares1)
```


```{r}
#Create samples
NROW(shares1)
training<-window(shares1, start = c(2012,1), end = c(2019,12))
#View(shares1)
NROW(shares1)
validation<-window(shares1, start = c(2020, 1))
#View(training)
NROW(validation)
```
The TBATS model combines several components of the already discussed techniques in this guide, making them a very good choice for forecasting.

It constitutes the following elements:

T: Trigonometric terms for seasonality
B: Box-Cox transformations for heterogeneity
A: ARMA errors for short-term dynamics
T: Trend
S: Seasonal (including multiple and non-integer periods)

The first line of code below creates the TBATS model and stores it in an object 'tbats_model'. The second line prints the summary and the forecasts for the next selected months.



```{r}
tbats_model = tbats(training)
tbats_forecast = forecast(tbats_model, h=length(validation))
MAPE(tbats_forecast$mean, validation) * 100
```
Naive Forecasting Method
The simplest forecasting method is to use the most recent observation as the forecast for the next observation. This is called a naive forecast and can be implemented using the 'naive()' function. This method may not be the best forecasting technique, but it often provides a useful benchmark for other, more advanced forecasting methods.

The first line of code below reads in the time series object 'training' and creates the naive forecasting model. The second argument 'h' specifies the number of values you want to forecast which is set to the number of our test cases, in our case. The third  line prints the summary of the model as well as the forecasted value for the next selected months.


```{r}
naive = snaive(training, h=length(validation))
MAPE(naive$mean, validation) * 100
summary(naive)
```

```{r}
plot(shares1, col="blue", xlab="Year", ylab="Stock Prices", main="Seasonal Naive Forecast", type='l')
lines(naive$mean, col="red", lwd=2)
```

```{r}
arima_optimal = auto.arima(training)

summary(arima_optimal)
```
Conclusion
In this guide, you have learned about several forecasting techniques using 'R'. The performance of the models on the test data is summarized below:


